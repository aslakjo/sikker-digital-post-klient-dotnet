using Microsoft.VisualStudio.TestTools.UnitTesting;
using Difi.SikkerDigitalPost.Klient.XmlValidering;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Xml;

namespace Difi.SikkerDigitalPost.Klient.XmlValidering.Tests
{
    [TestClass()]
    public class ResponsvalidatorTester
    {
        readonly string _responsXml = "<env:Envelope xmlns:env=\"http://www.w3.org/2003/05/soap-envelope\"><env:Header><wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" env:mustUnderstand=\"true\"><wsse:BinarySecurityToken EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" wsu:Id=\"X509-ebe20326-585e-4df5-a6ad-7b3acb04108e\">MIIE7jCCA9agAwIBAgIKGBj1bv99Jpi+EzANBgkqhkiG9w0BAQsFADBRMQswCQYDVQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMxNjMzMjcxIzAhBgNVBAMMGkJ1eXBhc3MgQ2xhc3MgMyBUZXN0NCBDQSAzMB4XDTE0MDQyNDEyMzExMVoXDTE3MDQyNDIxNTkwMFowVTELMAkGA1UEBhMCTk8xGDAWBgNVBAoMD1BPU1RFTiBOT1JHRSBBUzEYMBYGA1UEAwwPUE9TVEVOIE5PUkdFIEFTMRIwEAYDVQQFEwk5ODQ2NjExODUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDLTnQryf2bmiyQ9q3ylQ6xMl7EhGIbjuziXkRTfL+M94m3ceAiko+r2piefKCiquLMK4j+UDcOapUtLC4dT4c6GhRH4FIOEn5aNS2I/njTenBypWka/VEhQUj7zvIh5G4UXIDIXYvLd7gideeMtkX24KUh2XVlh+PcqLGHirqBwVfFiTn5SKhr/ojhYYEb2xxTk3AY9nLd1MMffKQwUWmfoTos4scREYGI2R2vWxKWPcDqk+jig2DISWSJSuerz3HMYAAmp+Gjt0oFJNiyOFaFyGwT3DvqwOMQWwWXdmLh1NxMgTpghXAaXae76ucm9GDQ9E7ytf+JA096RWoi+5GtAgMBAAGjggHCMIIBvjAJBgNVHRMEAjAAMB8GA1UdIwQYMBaAFD+u9XgLkqNwIDVfWvr3JKBSAfBBMB0GA1UdDgQWBBTVyVLqcjWf1Qd0gsmCTrhXiWeqVDAOBgNVHQ8BAf8EBAMCBLAwFgYDVR0gBA8wDTALBglghEIBGgEAAwIwgbsGA1UdHwSBszCBsDA3oDWgM4YxaHR0cDovL2NybC50ZXN0NC5idXlwYXNzLm5vL2NybC9CUENsYXNzM1Q0Q0EzLmNybDB1oHOgcYZvbGRhcDovL2xkYXAudGVzdDQuYnV5cGFzcy5uby9kYz1CdXlwYXNzLGRjPU5PLENOPUJ1eXBhc3MlMjBDbGFzcyUyMDMlMjBUZXN0NCUyMENBJTIwMz9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0MIGKBggrBgEFBQcBAQR+MHwwOwYIKwYBBQUHMAGGL2h0dHA6Ly9vY3NwLnRlc3Q0LmJ1eXBhc3Mubm8vb2NzcC9CUENsYXNzM1Q0Q0EzMD0GCCsGAQUFBzAChjFodHRwOi8vY3J0LnRlc3Q0LmJ1eXBhc3Mubm8vY3J0L0JQQ2xhc3MzVDRDQTMuY2VyMA0GCSqGSIb3DQEBCwUAA4IBAQCmMpAGaNplOgx3b4Qq6FLEcpnMOnPlSWBC7pQEDWx6OtNUHDm56fBoyVQYKR6LuGfalnnOKuB/sGSmO3eYlh7uDK9WA7bsNU/W8ZiwYwF6PBRui2rrqYk3kj4NLTNlyh/AOO1a2FDFHu369W0zcjj5ns7qs0K3peXtLX8pVxA8RmjwdGe69P/2r6s2A5CBj7oXZJD0Yo2dJFdsZzonT900sUi+MWzlhj3LxU5/684NWc2NI6ZPof/dyYpy3K/AFzpDLWGSmaDO66hPl7EfoJxEiX0DNBaQzNIyRFPh0ir0jM+32ZQ4goR8bAtyhKeTyA/4+Qx1WQXS3wURCC0lsbMh</wsse:BinarySecurityToken><wsu:Timestamp wsu:Id=\"TS-8256c36b-c7d9-4ecf-8c75-244b9b3b85b5\"><wsu:Created>2015-10-19T13:54:45.359Z</wsu:Created><wsu:Expires>2015-10-19T13:59:45.359Z</wsu:Expires></wsu:Timestamp><ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\" Id=\"SIG-5b7c2fcb-a73d-4432-ab4d-6b477d3dd2bb\"><ds:SignedInfo><ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\" PrefixList=\"env\"/></ds:CanonicalizationMethod><ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/><ds:Reference URI=\"#id-f7b60896-a4db-4bc3-83fa-007a01609cd2\"><ds:Transforms><ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\" PrefixList=\"\"/></ds:Transform></ds:Transforms><ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><ds:DigestValue>HDNZqleKy+ghHAemjUzXuO6H9xzZ2rlU/E5xGYNk/N4=</ds:DigestValue></ds:Reference><ds:Reference URI=\"#TS-8256c36b-c7d9-4ecf-8c75-244b9b3b85b5\"><ds:Transforms><ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\" PrefixList=\"wsse env\"/></ds:Transform></ds:Transforms><ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><ds:DigestValue>jtNIVmW2yro3w0SOCXBO6nynRwfamiJSA+0arXuAeno=</ds:DigestValue></ds:Reference><ds:Reference URI=\"#id-1c7fe6af-3963-4a09-a454-20d2866450f6\"><ds:Transforms><ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\" PrefixList=\"\"/></ds:Transform></ds:Transforms><ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><ds:DigestValue>/bgyLMZoid0pTpWHviP6VBZXq729xAZfQGNN8Rlnx9g=</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue>EFnoaHyJ2lZinlPBafWhyNmKqDUfIzCddpUAnTFKGllsTwW2962MwfqzkQiRHthbI5ApLky5wy+rN1RCgSugjmBOmSK9Pd6f6w3QwF/2lmFIw6AtmRcmodbAfX0EmJyxWjx7IVw0Sz1fwkc6MVWI+IoJySf0DSkDBMBwXllvyD/kSlMQFIH/Vr+r9VBCoEXxT6xpMtCKZBhHwNViD+DdO3xK2ah6YPyN2b4BuCq3LHD0McWG9dLq1wIefl8Akzo6EAQaIudwMW4Hx2qsnYRfF3isl4bWEu/vpHRSEvnem5rjxRtVHzb1ALvuNx/o3uGY3wDZ0MNbY3q63s7ZQEwspg==</ds:SignatureValue><ds:KeyInfo Id=\"KI-48db7fa6-3b3e-408b-92ee-bb9dcb2ac61f\"><wsse:SecurityTokenReference wsu:Id=\"STR-f33cade2-1035-4196-bbf6-0180e14ebac8\"><wsse:Reference URI=\"#X509-ebe20326-585e-4df5-a6ad-7b3acb04108e\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"/></wsse:SecurityTokenReference></ds:KeyInfo></ds:Signature></wsse:Security><eb:Messaging xmlns:eb=\"http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" env:mustUnderstand=\"true\" wsu:Id=\"id-1c7fe6af-3963-4a09-a454-20d2866450f6\"><ns6:SignalMessage xmlns:ns10=\"http://uri.etsi.org/2918/v1.2.1#\" xmlns:ns11=\"http://uri.etsi.org/01903/v1.3.2#\" xmlns:ns2=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ns3=\"http://www.unece.org/cefact/namespaces/StandardBusinessDocumentHeader\" xmlns:ns4=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:ns5=\"http://www.w3.org/2000/09/xmldsig#\" xmlns:ns6=\"http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/\" xmlns:ns7=\"http://docs.oasis-open.org/ebxml-bp/ebbp-signals-2.0\" xmlns:ns8=\"http://www.w3.org/1999/xlink\" xmlns:ns9=\"http://begrep.difi.no/sdp/schema_v10\"><ns6:MessageInfo><ns6:Timestamp>2015-10-19T15:54:45.358+02:00</ns6:Timestamp><ns6:MessageId>f41a9832-45dd-42e2-9401-4d9aa0000a09</ns6:MessageId><ns6:RefToMessageId>285c2559-7b21-41bc-a08a-cfcfdca3a6cf</ns6:RefToMessageId></ns6:MessageInfo><ns6:Receipt><ns7:NonRepudiationInformation><ns7:MessagePartNRInformation><ns5:Reference URI=\"cid:6bd5cbad-63ee-48d0-90ed-af46fcdb290f@meldingsformidler.sdp.difi.no\"><ns5:Transforms><ns5:Transform Algorithm=\"http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Signature-Transform\"/></ns5:Transforms><ns5:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><ns5:DigestValue>j1k/MpL8keEW8hxpwXM28QppVLydN2bsuatwdVsn66g=</ns5:DigestValue></ns5:Reference></ns7:MessagePartNRInformation><ns7:MessagePartNRInformation><ns5:Reference URI=\"#soapBody\"><ns5:Transforms><ns5:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/></ns5:Transforms><ns5:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/><ns5:DigestValue>GtpGn7j02J5uJmMpUfyTs7qZ+5/oyVMEalvQEMyR7kI=</ns5:DigestValue></ns5:Reference></ns7:MessagePartNRInformation></ns7:NonRepudiationInformation></ns6:Receipt></ns6:SignalMessage></eb:Messaging></env:Header><env:Body xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" wsu:Id=\"id-f7b60896-a4db-4bc3-83fa-007a01609cd2\"/></env:Envelope>";
        readonly string _sendtXml = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><env:Envelope xmlns:env=\"http://www.w3.org/2003/05/soap-envelope\"><env:Header><wsse:Security xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" env:mustUnderstand=\"true\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"><wsse:BinarySecurityToken wsu:Id=\"X509-d3c399a1-3384-43cb-9a57-2d631a89331a\" EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\">MIIE7jCCA9agAwIBAgIKGBj1bv99Jpi+EzANBgkqhkiG9w0BAQsFADBRMQswCQYDVQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMxNjMzMjcxIzAhBgNVBAMMGkJ1eXBhc3MgQ2xhc3MgMyBUZXN0NCBDQSAzMB4XDTE0MDQyNDEyMzExMVoXDTE3MDQyNDIxNTkwMFowVTELMAkGA1UEBhMCTk8xGDAWBgNVBAoMD1BPU1RFTiBOT1JHRSBBUzEYMBYGA1UEAwwPUE9TVEVOIE5PUkdFIEFTMRIwEAYDVQQFEwk5ODQ2NjExODUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDLTnQryf2bmiyQ9q3ylQ6xMl7EhGIbjuziXkRTfL+M94m3ceAiko+r2piefKCiquLMK4j+UDcOapUtLC4dT4c6GhRH4FIOEn5aNS2I/njTenBypWka/VEhQUj7zvIh5G4UXIDIXYvLd7gideeMtkX24KUh2XVlh+PcqLGHirqBwVfFiTn5SKhr/ojhYYEb2xxTk3AY9nLd1MMffKQwUWmfoTos4scREYGI2R2vWxKWPcDqk+jig2DISWSJSuerz3HMYAAmp+Gjt0oFJNiyOFaFyGwT3DvqwOMQWwWXdmLh1NxMgTpghXAaXae76ucm9GDQ9E7ytf+JA096RWoi+5GtAgMBAAGjggHCMIIBvjAJBgNVHRMEAjAAMB8GA1UdIwQYMBaAFD+u9XgLkqNwIDVfWvr3JKBSAfBBMB0GA1UdDgQWBBTVyVLqcjWf1Qd0gsmCTrhXiWeqVDAOBgNVHQ8BAf8EBAMCBLAwFgYDVR0gBA8wDTALBglghEIBGgEAAwIwgbsGA1UdHwSBszCBsDA3oDWgM4YxaHR0cDovL2NybC50ZXN0NC5idXlwYXNzLm5vL2NybC9CUENsYXNzM1Q0Q0EzLmNybDB1oHOgcYZvbGRhcDovL2xkYXAudGVzdDQuYnV5cGFzcy5uby9kYz1CdXlwYXNzLGRjPU5PLENOPUJ1eXBhc3MlMjBDbGFzcyUyMDMlMjBUZXN0NCUyMENBJTIwMz9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0MIGKBggrBgEFBQcBAQR+MHwwOwYIKwYBBQUHMAGGL2h0dHA6Ly9vY3NwLnRlc3Q0LmJ1eXBhc3Mubm8vb2NzcC9CUENsYXNzM1Q0Q0EzMD0GCCsGAQUFBzAChjFodHRwOi8vY3J0LnRlc3Q0LmJ1eXBhc3Mubm8vY3J0L0JQQ2xhc3MzVDRDQTMuY2VyMA0GCSqGSIb3DQEBCwUAA4IBAQCmMpAGaNplOgx3b4Qq6FLEcpnMOnPlSWBC7pQEDWx6OtNUHDm56fBoyVQYKR6LuGfalnnOKuB/sGSmO3eYlh7uDK9WA7bsNU/W8ZiwYwF6PBRui2rrqYk3kj4NLTNlyh/AOO1a2FDFHu369W0zcjj5ns7qs0K3peXtLX8pVxA8RmjwdGe69P/2r6s2A5CBj7oXZJD0Yo2dJFdsZzonT900sUi+MWzlhj3LxU5/684NWc2NI6ZPof/dyYpy3K/AFzpDLWGSmaDO66hPl7EfoJxEiX0DNBaQzNIyRFPh0ir0jM+32ZQ4goR8bAtyhKeTyA/4+Qx1WQXS3wURCC0lsbMh</wsse:BinarySecurityToken><wsu:Timestamp wsu:Id=\"TS-1ee2fee7-d916-4fa7-9688-1a12c50c9fab\"><wsu:Created>2015-10-19T13:54:43.975Z</wsu:Created><wsu:Expires>2015-10-19T13:56:43.975Z</wsu:Expires></wsu:Timestamp><Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><InclusiveNamespaces PrefixList=\"env\" xmlns=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></CanonicalizationMethod><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\" /><Reference URI=\"#soapBody\"><Transforms><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\" /><DigestValue>GtpGn7j02J5uJmMpUfyTs7qZ+5/oyVMEalvQEMyR7kI=</DigestValue></Reference><Reference URI=\"#TS-1ee2fee7-d916-4fa7-9688-1a12c50c9fab\"><Transforms><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><InclusiveNamespaces PrefixList=\"wsse env\" xmlns=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></Transform></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\" /><DigestValue>ZSzH3gxryyC+zZhzl4Ff7qvnVDJ0p7jtKrFXkho9hjE=</DigestValue></Reference><Reference URI=\"#id-dbe62dd3-543f-4c53-9e6f-0c4017d8866b\"><Transforms><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\" /><DigestValue>PSrLaXTp+nlQJ9ujer/st8+vjh7keMPGbDd0mTPYwmg=</DigestValue></Reference><Reference URI=\"cid:6bd5cbad-63ee-48d0-90ed-af46fcdb290f@meldingsformidler.sdp.difi.no\"><Transforms><Transform Algorithm=\"http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Signature-Transform\" /></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\" /><DigestValue>j1k/MpL8keEW8hxpwXM28QppVLydN2bsuatwdVsn66g=</DigestValue></Reference></SignedInfo><SignatureValue>e5xbigJzrU2fVFi3/VwGC4BcDkla9NWeo2fbuGyFsxq3y13XsPRv4+nEJTs8tVJ/8Ia3+cOYo1yl7VxndnaawAgZR5yFocRXRLrVS3IHm063AXfMdrasg/zszl/68Ug29EghdNEktShi1d9Hi1qxXZNaVKJjpJTnfrLlHMTdKIY1UNZ2PXZaBdAPFL8BSzFaYU4kmsHkbKFG8ddi/NzP3/HuYC2c59zqN1ijUry0V8GDK5YimauwCamwsCTBdj0AwF7eNul4bzHoEt1y3F7lwWm6Ljepq3SA6TaO3PDQZ6WEzLsEPYl/g3I7q4z7aQEOtxxeYFoAYcw6Pl/XSHA74g==</SignatureValue><KeyInfo><SecurityTokenReference xmlns=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"><Reference URI=\"#X509-d3c399a1-3384-43cb-9a57-2d631a89331a\" ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\" /></SecurityTokenReference></KeyInfo></Signature></wsse:Security><eb:Messaging xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" env:mustUnderstand=\"true\" wsu:Id=\"id-dbe62dd3-543f-4c53-9e6f-0c4017d8866b\" xmlns:eb=\"http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/\"><eb:UserMessage mpc=\"urn:normal:d4a793cd-a527-42b8-afa6-ddeabfa5fdd0\"><eb:MessageInfo><eb:Timestamp>2015-10-19T13:54:43.977Z</eb:Timestamp><eb:MessageId>285c2559-7b21-41bc-a08a-cfcfdca3a6cf</eb:MessageId></eb:MessageInfo><eb:PartyInfo><eb:From><eb:PartyId type=\"urn:oasis:names:tc:ebcore:partyid-type:iso6523:9908\">9908:984661185</eb:PartyId><eb:Role>urn:sdp:avsender</eb:Role></eb:From><eb:To><eb:PartyId type=\"urn:oasis:names:tc:ebcore:partyid-type:iso6523:9908\">9908:984661185</eb:PartyId><eb:Role>urn:sdp:meldingsformidler</eb:Role></eb:To></eb:PartyInfo><eb:CollaborationInfo><eb:AgreementRef>http://begrep.difi.no/SikkerDigitalPost/1.0/transportlag/Meldingsutveksling/FormidleDigitalPostForsendelse</eb:AgreementRef><eb:Service>SDP</eb:Service><eb:Action>FormidleDigitalPost</eb:Action><eb:ConversationId>b51ab501-ef5c-4950-bece-e7d47199fcd2</eb:ConversationId></eb:CollaborationInfo><eb:PayloadInfo><eb:PartInfo href=\"#soapBody\" /><eb:PartInfo href=\"cid:6bd5cbad-63ee-48d0-90ed-af46fcdb290f@meldingsformidler.sdp.difi.no\"><eb:PartProperties><eb:Property name=\"MimeType\">application/cms</eb:Property><eb:Property name=\"Content\">sdp:Dokumentpakke</eb:Property></eb:PartProperties></eb:PartInfo></eb:PayloadInfo></eb:UserMessage></eb:Messaging></env:Header><env:Body xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\" wsu:Id=\"soapBody\"><ns3:StandardBusinessDocument xmlns:ns3=\"http://www.unece.org/cefact/namespaces/StandardBusinessDocumentHeader\" xmlns:ns5=\"http://www.w3.org/2000/09/xmldsig#\" xmlns:ns9=\"http://begrep.difi.no/sdp/schema_v10\"><ns3:StandardBusinessDocumentHeader><ns3:HeaderVersion>1.0</ns3:HeaderVersion><ns3:Sender><ns3:Identifier Authority=\"iso6523-actorid-upis\">9908:984661185</ns3:Identifier></ns3:Sender><ns3:Receiver><ns3:Identifier Authority=\"iso6523-actorid-upis\">9908:984661185</ns3:Identifier></ns3:Receiver><ns3:DocumentIdentification><ns3:Standard>urn:no:difi:sdp:1.0</ns3:Standard><ns3:TypeVersion>1.0</ns3:TypeVersion><ns3:InstanceIdentifier>285c2559-7b21-41bc-a08a-cfcfdca3a6cf</ns3:InstanceIdentifier><ns3:Type>digitalPost</ns3:Type><ns3:CreationDateAndTime>2015-10-19T13:54:43.978Z</ns3:CreationDateAndTime></ns3:DocumentIdentification><ns3:BusinessScope><ns3:Scope><ns3:Type>ConversationId</ns3:Type><ns3:InstanceIdentifier>b51ab501-ef5c-4950-bece-e7d47199fcd2</ns3:InstanceIdentifier><ns3:Identifier>urn:no:difi:sdp:1.0</ns3:Identifier></ns3:Scope></ns3:BusinessScope></ns3:StandardBusinessDocumentHeader><ns9:digitalPost><Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /><SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\" /><Reference URI=\"\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\" /><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"><InclusiveNamespaces PrefixList=\"ns9\" xmlns=\"http://www.w3.org/2001/10/xml-exc-c14n#\" /></Transform></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\" /><DigestValue>VmGQ0KvtZQSbxmt7qfNWf/lAgJS5cJzSqneJMj2ad04=</DigestValue></Reference></SignedInfo><SignatureValue>oVTPAlsMdMQDFqU4Ch5WjWD1XCxDoz9OGJdMf4VnKjnCyA7Ae3nW03s9LJ2ekq9XJs3TmU9Ih+IWRZWf4t8mTEl1Ls4SHjbnvnEcpCSaCR1HGVneocLVtc4vZURnCPDEhOMRgBHTlD1i8zT2DG9djAN02C4vBK9tLyxiJhX22f9m8bij7B6kqnLXzLZHCGMJbVhi09Nz4nxVZIFLaC+62hj6GDsCSsSJA1PTeral9XzP6vaAhwRt6r122mQA18Jkry9SdBGT32jQwS/l2fbTfVU9OvolqgRiHVrmLT9+TJq23zXLyDMIjqPnkdwkvZmQoKJuakBifUw3zqtc1MdFUA==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIE7jCCA9agAwIBAgIKGBj1bv99Jpi+EzANBgkqhkiG9w0BAQsFADBRMQswCQYDVQQGEwJOTzEdMBsGA1UECgwUQnV5cGFzcyBBUy05ODMxNjMzMjcxIzAhBgNVBAMMGkJ1eXBhc3MgQ2xhc3MgMyBUZXN0NCBDQSAzMB4XDTE0MDQyNDEyMzExMVoXDTE3MDQyNDIxNTkwMFowVTELMAkGA1UEBhMCTk8xGDAWBgNVBAoMD1BPU1RFTiBOT1JHRSBBUzEYMBYGA1UEAwwPUE9TVEVOIE5PUkdFIEFTMRIwEAYDVQQFEwk5ODQ2NjExODUwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDLTnQryf2bmiyQ9q3ylQ6xMl7EhGIbjuziXkRTfL+M94m3ceAiko+r2piefKCiquLMK4j+UDcOapUtLC4dT4c6GhRH4FIOEn5aNS2I/njTenBypWka/VEhQUj7zvIh5G4UXIDIXYvLd7gideeMtkX24KUh2XVlh+PcqLGHirqBwVfFiTn5SKhr/ojhYYEb2xxTk3AY9nLd1MMffKQwUWmfoTos4scREYGI2R2vWxKWPcDqk+jig2DISWSJSuerz3HMYAAmp+Gjt0oFJNiyOFaFyGwT3DvqwOMQWwWXdmLh1NxMgTpghXAaXae76ucm9GDQ9E7ytf+JA096RWoi+5GtAgMBAAGjggHCMIIBvjAJBgNVHRMEAjAAMB8GA1UdIwQYMBaAFD+u9XgLkqNwIDVfWvr3JKBSAfBBMB0GA1UdDgQWBBTVyVLqcjWf1Qd0gsmCTrhXiWeqVDAOBgNVHQ8BAf8EBAMCBLAwFgYDVR0gBA8wDTALBglghEIBGgEAAwIwgbsGA1UdHwSBszCBsDA3oDWgM4YxaHR0cDovL2NybC50ZXN0NC5idXlwYXNzLm5vL2NybC9CUENsYXNzM1Q0Q0EzLmNybDB1oHOgcYZvbGRhcDovL2xkYXAudGVzdDQuYnV5cGFzcy5uby9kYz1CdXlwYXNzLGRjPU5PLENOPUJ1eXBhc3MlMjBDbGFzcyUyMDMlMjBUZXN0NCUyMENBJTIwMz9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0MIGKBggrBgEFBQcBAQR+MHwwOwYIKwYBBQUHMAGGL2h0dHA6Ly9vY3NwLnRlc3Q0LmJ1eXBhc3Mubm8vb2NzcC9CUENsYXNzM1Q0Q0EzMD0GCCsGAQUFBzAChjFodHRwOi8vY3J0LnRlc3Q0LmJ1eXBhc3Mubm8vY3J0L0JQQ2xhc3MzVDRDQTMuY2VyMA0GCSqGSIb3DQEBCwUAA4IBAQCmMpAGaNplOgx3b4Qq6FLEcpnMOnPlSWBC7pQEDWx6OtNUHDm56fBoyVQYKR6LuGfalnnOKuB/sGSmO3eYlh7uDK9WA7bsNU/W8ZiwYwF6PBRui2rrqYk3kj4NLTNlyh/AOO1a2FDFHu369W0zcjj5ns7qs0K3peXtLX8pVxA8RmjwdGe69P/2r6s2A5CBj7oXZJD0Yo2dJFdsZzonT900sUi+MWzlhj3LxU5/684NWc2NI6ZPof/dyYpy3K/AFzpDLWGSmaDO66hPl7EfoJxEiX0DNBaQzNIyRFPh0ir0jM+32ZQ4goR8bAtyhKeTyA/4+Qx1WQXS3wURCC0lsbMh</X509Certificate></X509Data></KeyInfo></Signature><ns9:avsender><ns9:organisasjon authority=\"iso6523-actorid-upis\">9908:984661185</ns9:organisasjon><ns9:avsenderidentifikator>digipost</ns9:avsenderidentifikator><ns9:fakturaReferanse></ns9:fakturaReferanse></ns9:avsender><ns9:mottaker><ns9:person><ns9:personidentifikator>04036125433</ns9:personidentifikator><ns9:postkasseadresse>ove.jonsen#6K5A</ns9:postkasseadresse></ns9:person></ns9:mottaker><ns9:digitalPostInfo><ns9:virkningstidspunkt>2015-10-19T15:54:37.202+02:00</ns9:virkningstidspunkt><ns9:aapningskvittering>false</ns9:aapningskvittering><ns9:sikkerhetsnivaa>4</ns9:sikkerhetsnivaa><ns9:ikkeSensitivTittel lang=\"no\">Ikke-sensitiv tittel</ns9:ikkeSensitivTittel><ns9:varsler /></ns9:digitalPostInfo><ns9:dokumentpakkefingeravtrykk><ns5:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\" /><ns5:DigestValue>j1k/MpL8keEW8hxpwXM28QppVLydN2bsuatwdVsn66g=</ns5:DigestValue></ns9:dokumentpakkefingeravtrykk></ns9:digitalPost></ns3:StandardBusinessDocument></env:Body></env:Envelope>";

        private XmlDocument SendtMeldingXmlDocument
        {
            get
            {
                XmlDocument sendtMelding = new XmlDocument();
                sendtMelding.LoadXml(_sendtXml);
                return sendtMelding;
            }
        }

        [TestClass]
        public class KonstruktørMethod : ResponsvalidatorTester
        {
            [TestMethod]
            public void EnkelKonstruktørMedMiljø()
            {
                ////Arrange
                var sendtMelding = SendtMeldingXmlDocument;
                var miljø = Miljø.Test;
                Responsvalidator responsvalidator = new Responsvalidator(_responsXml, sendtMelding, miljø);

                //Act

                //Assert
                Assert.AreEqual(miljø, responsvalidator.Miljø);
            }

        
        }

        [TestClass]
        public class ValiderHeaderSignatur : ResponsvalidatorTester
        {
            [TestMethod]
            public void ValidererTestsertifikat()
            {
                //Arrange
                var sendtMelding = SendtMeldingXmlDocument;
                var miljø = Miljø.Test;
                Responsvalidator responsvalidator = new Responsvalidator(_responsXml, sendtMelding, miljø);

                //Act
                responsvalidator.ValiderHeaderSignatur();
                
                //Assert
            } 
        }
    }
}